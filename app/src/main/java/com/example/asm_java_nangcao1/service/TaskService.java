package com.example.asm_java_nangcao1.service;import android.annotation.SuppressLint;import android.app.NotificationChannel;import android.app.NotificationManager;import android.app.PendingIntent;import android.app.Service;import android.content.Intent;import android.content.SharedPreferences;import android.graphics.Bitmap;import android.graphics.BitmapFactory;import android.os.Build;import android.os.Bundle;import android.os.IBinder;import android.widget.Toast;import androidx.core.app.NotificationCompat;import androidx.core.app.NotificationManagerCompat;import com.example.asm_java_nangcao1.Activity.sanPham_Activity;import com.example.asm_java_nangcao1.Model.gioHang_Model;import com.example.asm_java_nangcao1.Model.khoHang_Model;import com.example.asm_java_nangcao1.Model.nameSanPham_Model;import com.example.asm_java_nangcao1.R;import com.google.firebase.database.ChildEventListener;import com.google.firebase.database.DataSnapshot;import com.google.firebase.database.DatabaseError;import com.google.firebase.database.DatabaseReference;import com.google.firebase.database.FirebaseDatabase;import java.util.ArrayList;public class TaskService extends Service {    public TaskService() {    }    String context = "GreenLeafs đang chạy";    FirebaseDatabase db;    SharedPreferences checkTask;    DatabaseReference node;    NotificationManagerCompat notificationManager;    public static String NOTIFICATION_CHANNEL = "Thông báo của app";    PendingIntent pendingIntent;    //chạy khi khởi tạo service    @Override    public int onStartCommand(Intent intent, int flags, int startId) {////        xin cấp quyền cho android        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {            CharSequence name = "Kên thông báo";            String description = "Mô tả thông báo";            int importance = NotificationManager.IMPORTANCE_DEFAULT;            NotificationChannel channel = new NotificationChannel(NOTIFICATION_CHANNEL, name, importance);            channel.setDescription(description);            NotificationManager notificationManager = getSystemService(NotificationManager.class);            notificationManager.createNotificationChannel(channel);        }        //    Firebase        notificationManager = NotificationManagerCompat.from(TaskService.this);Intent intent1 = new Intent(TaskService.this,sanPham_Activity.class);        intent1.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);        pendingIntent = PendingIntent.getActivity(TaskService.this, 0, intent1, 0);        Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.drawable.logonotifi);        db = FirebaseDatabase.getInstance("https://asmandroid-duan1-default-rtdb.asia-southeast1.firebasedatabase.app/");        node = db.getReference("khoHang");        node.addChildEventListener(new ChildEventListener() {            @Override            public void onChildAdded(DataSnapshot snapshot, String previousChildName) {                Intent fullScreenIntent = new Intent(TaskService.this, sanPham_Activity.class);                PendingIntent fullScreenPendingIntent = PendingIntent.getActivity(TaskService.this, 0,                        fullScreenIntent, PendingIntent.FLAG_UPDATE_CURRENT);                NotificationCompat.Builder builder = new NotificationCompat.Builder(TaskService.this,                        NOTIFICATION_CHANNEL)                        .setSmallIcon(R.drawable.ic_shop_notification)                        .setContentTitle(context)                        .setContentText("Có sản phẩm mới được thêm!")                        .setContentIntent(pendingIntent)                        .setLargeIcon(bitmap)                        .setPriority(NotificationCompat.PRIORITY_DEFAULT)                        .setFullScreenIntent(fullScreenPendingIntent, true);// notificationId is a unique int for each notification that you must define                notificationManager.notify(33, builder.build());            }            @Override            public void onChildChanged(DataSnapshot snapshot, String previousChildName) {            }            @Override            public void onChildRemoved(DataSnapshot snapshot) {            }            @Override            public void onChildMoved(DataSnapshot snapshot, String previousChildName) {            }            @Override            public void onCancelled(DatabaseError error) {            }        });        return super.onStartCommand(intent, flags, startId);    }    @Override    public void onDestroy() {        super.onDestroy();    }    @Override    public IBinder onBind(Intent intent) {        // TODO: Return the communication channel to the service.        throw new UnsupportedOperationException("Not yet implemented");    }}